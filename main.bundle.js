!function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=5)}([function(t,e,n){"use strict";n.d(e,"d",function(){return r}),n.d(e,"h",function(){return o}),n.d(e,"e",function(){return c}),n.d(e,"g",function(){return u}),n.d(e,"b",function(){return i}),n.d(e,"c",function(){return s}),n.d(e,"f",function(){return a}),n.d(e,"a",function(){return d});const r=(t,e,n)=>({x:t,y:e,z:n}),o=(t,e)=>r(t*e.x,t*e.y,t*e.z),c=(t,e)=>r(t.x-e.x,t.y-e.y,t.z-e.z),u=(t,e)=>r(t.x+e.x,t.y+e.y,t.z+e.z),i=(t,e)=>t.x*e.x+t.y*e.y+t.z*e.z,s=t=>Math.sqrt(Math.pow(t.x,2)+Math.pow(t.y,2)+Math.pow(t.z,2)),a=t=>{const e=s(t);return o(0===e?1/0:1/e,t)},d=(t,e)=>r(t.y*e.z-t.z*e.y,t.z*e.x-t.x*e.z,t.x*e.y-t.y*e.x)},function(t,e,n){"use strict";n.d(e,"j",function(){return r}),n.d(e,"e",function(){return o}),n.d(e,"b",function(){return c}),n.d(e,"a",function(){return u}),n.d(e,"c",function(){return i}),n.d(e,"g",function(){return s}),n.d(e,"f",function(){return a}),n.d(e,"h",function(){return d}),n.d(e,"i",function(){return l}),n.d(e,"d",function(){return f});const r={r:1,g:1,b:1},o={r:.5,g:.5,b:.5},c={r:0,g:0,b:0},u=c,i=c,s=(t,e)=>({r:t*e.r,g:t*e.g,b:t*e.b}),a=(t,e)=>({r:t.r+e.r,g:t.g+e.g,b:t.b+e.b}),d=(t,e)=>({r:t.r*e.r,g:t.g*e.g,b:t.b*e.b}),l=t=>({r:Math.floor(255*Math.min(1,t.r)),g:Math.floor(255*Math.min(1,t.g)),b:Math.floor(255*Math.min(1,t.b))}),f=t=>(t=>({r:(t>>16&255)/255,g:(t>>8&255)/255,b:(255&t)/255}))(parseInt(t,16))},function(t,e,n){"use strict";n.d(e,"a",function(){return o}),n.d(e,"b",function(){return c});var r=n(0);const o=(t,e,n)=>({handlerId:"sphere",surfaceId:n,center:t,radius2:Math.pow(e,2)}),c={intersect:(t,e)=>{const n=Object(r.e)(e.center,t.start),o=Object(r.b)(n,t.dir);let c=0;if(o>=0){const t=e.radius2-(Object(r.b)(n,n)-o*o);t>=0&&(c=o-Math.sqrt(t))}return 0!==c?c:null},normal:(t,e)=>Object(r.f)(Object(r.e)(t,e.center))}},function(t,e,n){"use strict";n.d(e,"a",function(){return o}),n.d(e,"b",function(){return c});var r=n(0);const o=(t,e,n)=>({handlerId:"plane",surfaceId:n,normal:Object(r.f)(t),offset:e}),c={intersect:(t,e)=>{const n=Object(r.b)(e.normal,t.dir);return n>0?null:(Object(r.b)(e.normal,t.start)+e.offset)/-n},normal:(t,e)=>e.normal}},,function(t,e,n){"use strict";n.r(e);const r={chunks:[]};class o{constructor(t=16){this.items=new Array(t)}enqueue(t){this.items.push(t)}dequeue(){return this.items.shift()||r}}var c=n(0);const u=Object(c.d)(0,-1,0);var i=n(1),s=n(3),a=n(2);class d{constructor(){this.worker=new Worker("worker.bundle.js")}setScene(t){return new Promise(e=>{this.worker.postMessage({scene:t}),this.worker.addEventListener("message",()=>e(null),{once:!0})})}setCamera(t){return new Promise(e=>{this.worker.postMessage({camera:t}),this.worker.addEventListener("message",()=>e(null),{once:!0})})}traceRect(t){return new Promise(e=>{this.worker.postMessage({rect:t}),this.worker.addEventListener("message",({data:t})=>e(t),{once:!0})})}}class l{constructor(t){this.pool=Array(t).fill(null).map(()=>new d)}setScene(t){return Promise.all(this.pool.map(e=>e.setScene(t))).then(()=>null)}setCamera(t){return this.camera=t,Promise.all(this.pool.map(e=>e.setCamera(t))).then(()=>null)}trace(t){return Promise.all(this.pool.map((t,e,{length:n})=>t.traceRect({x:0,y:Math.floor(this.camera.height/n*e),w:this.camera.width,h:Math.ceil(this.camera.height/n)}))).then(e=>({id:t,chunks:e}))}}var f=function(t,e,n,r){return new(n||(n=Promise))(function(o,c){function u(t){try{s(r.next(t))}catch(t){c(t)}}function i(t){try{s(r.throw(t))}catch(t){c(t)}}function s(t){t.done?o(t.value):new n(function(e){e(t.value)}).then(u,i)}s((r=r.apply(t,e||[])).next())})};const h=Object(c.d)(4,3,5),b=Object(c.d)(-1,.5,0),m=(t,e,n)=>((t,e,n,r)=>{const o=Object(c.f)(Object(c.e)(e,t)),i=Object(c.h)(1.5,Object(c.f)(Object(c.a)(o,u)));return{pos:t,forward:o,right:i,up:Object(c.h)(1.5,Object(c.f)(Object(c.a)(o,i))),width:n,height:r}})(Object(c.d)(Math.cos(n)*(h.x-b.x)-Math.sin(n)*(h.z-b.z)+b.x,h.y,Math.sin(n)*(h.x-b.x)+Math.cos(n)*(h.z-b.z)+b.z),b,t,e);document.body.onload=(()=>f(void 0,void 0,void 0,function*(){const t=document.getElementById("canvas");if(!t.getContext)throw new Error("Application can not be drawn.");{const e=t.getContext("2d"),n=new l(4),r=new o,u=()=>window.requestAnimationFrame(()=>{r.dequeue().chunks.forEach(({position:{x:t,y:n},image:r})=>{e.putImageData(r,t,n)}),u()});setTimeout(u,1e3);const d=(()=>({bodies:[Object(s.a)(Object(c.d)(0,1,0),0,"checkerboard"),Object(a.a)(Object(c.d)(0,1,-.25),1,"shiny"),Object(a.a)(Object(c.d)(-1,.5,1.5),.5,"shiny"),Object(a.a)(Object(c.d)(-4,.7,-1.5),.7,"matt")],lights:[{pos:Object(c.d)(-2,2.5,0),color:Object(i.d)("7d1212")},{pos:Object(c.d)(1.5,2.5,1.5),color:Object(i.d)("12127d")},{pos:Object(c.d)(1.5,2.5,-1.5),color:Object(i.d)("127d12")},{pos:Object(c.d)(0,3.5,0),color:Object(i.d)("363659")}]}))();yield n.setScene(d);for(let e=0,o=0;e<3&&o<1;e+=.01,o++){const c=m(t.width,t.height,e);yield n.setCamera(c),yield n.trace(o).then(t=>r.enqueue(t))}}}))}]);